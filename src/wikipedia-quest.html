<link rel="import" href="node_modules/@polymer/polymer/polymer.html" />

<dom-module id="wikipedia-quest">
	<template>
		<style>
			#title{
				/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#666666+0,343434+100 */
				background: #666666; /* Old browsers */
				background: -moz-linear-gradient(top,  #666666 0%, #343434 100%); /* FF3.6-15 */
				background: -webkit-linear-gradient(top,  #666666 0%,#343434 100%); /* Chrome10-25,Safari5.1-6 */
				background: linear-gradient(to bottom,  #666666 0%,#343434 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
				filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#666666', endColorstr='#343434',GradientType=0 ); /* IE6-9 */
			}
			#title h1{
				text-align: center;
				padding-top: .67em;
				padding-bottom: .67em;
				margin: 0;
				color:#F1f1d4;
			}
			#navBar{
				text-align:center;
				background-color: #333;
			}
			ul.topnav {
				list-style-type: none;
				margin: 0;
				padding: 0;
				overflow: hidden;
				display: block;
				max-width:960px;
				width: 100%;
				
				margin: auto;
			}
			
			ul.topnav li {
				float:left;
				width:320px;
			}
			ul.topnav li a {
				display: inline-block;
				box-sizing: border-box;
				color: #F1f1d4;
				text-decoration: none;
				transition: 0.3s;
				font-size: 17px;
				width: 100%;
				padding-top: 16px;
				padding-bottom: 16px;
				border-style: solid;
				border-color: gray;
				border-top-style: none;
				border-bottom-style: none;
				border-width: 1px;
			}
			
			@media(max-width:959px){
				ul.topnav li{
					width: 33.3333%;
				}
			
			}

			ul.topnav li a:hover {
				background-color: #111;
			}
			
			#mainContent{
				max-width: 960px;
				margin: auto;
			}
			
			div.explore div{
				box-sizing: border-box;
				float: left;
				max-height:600px;
				padding: 5px;
				background-color:#f0f0f0
				overflow:hidden;
			}
			
			#overview {
				width: 75%;
				height:500px;
			}
			#links{
				width: 25%;
				height:500px;
			}
			#explore{
				width: 75%;
			}
			#search{
				width: 25%;
			}
			
			#pageImage{
				max-width: 200px;
				float: left;
				padding: 15px;
			}
		</style>
  <header>
	<div id="title">
	<h1>Wikipedia Quest</h1>
	
	</div>

	<div id="navBar">
		<ul class="topnav">
			<li><a href="/menu">Main Menu</a></li>
			<li><a href="/explore">Explore</a></li>
			<li><a href="/questLog">Quest Log</a></li>
		</ul>
	</div>
	</header>
	
	<div id="mainContent">
    
		<template is="dom-if" if="[[mainMenuView_]]">
			<div class="menu" hidden=[[!display_]]>
					<p>
					This is the main menu view!<br>
					It's responsible for allowing the player to 
					save and/or load their progress, as well as 
					set preferences like font size.
					
					</p>
			</div>
		</template>
		
		<template is="dom-if" if="[[exploreView_]]">
			<div class="explore" hidden=[[!display_]]>
		
				<div id="overview">
				<img id="pageImage" src="[[pageImageURL]]"/>
				<p id="pageSummary">[[pageSummary]]</p>
				
				</div>

				<div id="links">
				<p>Links Go Here!</p>
				<ul>
					<li><a href="/explore/Kevin%20Bacon">Bacon (Kevin)</a></li>
					<li><a href="/explore/Lorem%20Ipsum%201">Lorem Ipsum 1</a></li>
					<li><a href="/explore/Lorem%20Ipsum%202">Lorem Ipsum 2</a></li>
					<li><a href="/explore/Lorem%20Ipsum%203">Lorem Ipsum 3</a></li>
					<li><a href="/explore/Lorem%20Ipsum%204">Lorem Ipsum 4</a></li>
				</ul>
				</div>

				<div id="explore">
				<p><a href="http://en.wikipedia.org/wiki/Bacon" target="_blank">Explore!</a></p>
				
				</div>

				<div id="search">
				<p>Search!</p>
				</div>
		
			</div>
		</template>
		
		<template is="dom-if" if="[[questView_]]">
			<div class="quest" hidden=[[!display_]]>
				<p>
				This is the quest view!<br>
				It's responsible for showing the user their overall goal, as well as
				various statistics such as time spent playing and total number of pages
				visited.
				</p>
			</div>
    </template>
	
	</div>
   
  </template>
  <script>
    // element registration
    Polymer({
      is: "wikipedia-quest",

      
		properties: {
		
			currentWikiPage: String,
			pageSummary: String,
			pageImageURL: String,
			errorMsg: String,
			playerInitialized_: {
				type: Boolean,
				value: false
			},
			loading_: {
				type: Boolean,
				value: true
			},
			error_: {
				type: Boolean,
				value: false
			},
			display_: {
				type: Boolean,
				value: false
			},
			mainMenuView_:{
				type: Boolean,
				value: true
			},
			exploreView_: {
				type: Boolean,
				value: false
			},
			firstVisit_:{
				type: Boolean,
				value: false
			}
    },

    attached: function () {
      this.welcomeUser_();
    },
	  
	  welcomeUser_: function(){
			this.loading_ = true;
			this.display_ = false;
			this.mainMenuView_ = true;
			this.exploreView_ = false;
			this.questView_ = false;
			
			//Check if the browser has save data stored in it.
			//If so, set the proper values, which are used by menu's html.
			
			//If not, set any necessary values, which are also used by menu's html.
			
			this.loading_ = false;
			this.display_ = true;
	  },
	  
		beginNewGame_: function(){
			//Do all of the javascript-side setup for a new game:
			// Select two random pages
			// Make sure that all of the proper variables are initialized to zero.
			loadQuestView_();
		},

		loadQuestView_: function(){
			this.loading_ = true;
			this.display_ = false;
			this.mainMenuView_ = false;
			this.exploreView_ = false;
			this.questView_ = true;
		
		
			
			this.loading_ = false;
			this.display_ = true;
		},
		
		loadMainMenu_: function(){
			this.loading_ = true;
			this.display_ = false;
			this.mainMenuView_ = true;
			this.exploreView_ = false;
			this.questView_ = false;
			

			
			this.loading_ = false;
			this.display_ = true;
		},

		attributeChanged: function (name, type) {
			if (/^currentWikiPage$/i.test(name)) {
				this.loadWikiPage_();
			}
		},
	  
		loadWikiPage_: function () {
			this.loading_ = true;
			this.display_ = false;
			this.error_ = false;
			this.mainMenuView_ = false;
			this.exploreView_ = true;
			this.questView_ = false;
	  

		
			this.pageSummary = 	"Bacon is a meat product prepared from a pig and usually cured." +
								"It is first cured using large quantities of salt, either in a " +
								"brine or in a dry packing; the result is fresh bacon (also known" +
								"as green bacon). Fresh bacon may then be further dried for weeks " +
								"or months in cold air, or it may be boiled or smoked. Fresh and " +
								"dried bacon is typically cooked before eating, often by frying. " +
								"Boiled bacon is ready to eat, as is some smoked bacon, but may be " +
								"cooked further before eating.";
								
			this.pageImageURL = "https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Made20bacon.png/320px-Made20bacon.png"
	    
			//Make a call to the mediaWiki API here.
			/*
			 {}.bind(this))
					.catch((function (err) {
				if(err.message === "server500Error"){
				this.errorMsg = "A server error occurred. Sorry!";
				this.error_ = true;
			}
			if(err.message === "server404Error"){
				this.errorMsg = "We have no data for that date.";
				this.error_ = true;
			}
						if(err.message === "invalidDate"){
				this.errorMsg = "The submitted date was invalid.";
				this.error_ = true;
			}
			this.loading_ = false;
			this.display_ = false;
			
					}).bind(this));
			*/
		
			this.loading_ = false;
			this.display_ = true;
		},
	  
	  removeAllLinks: function() {
		//Same idea, but remove links instead.
		/*var Ul = this.$.listOfEvents;
		
		while(Ul.firstChild != null){
			Ul.firstChild.remove();
		}*/
	  },
	  
	  insertAllEvents: function() {
		//Add links with the wiki names
		//The links will go to the page routing, though.
		
		/*
		var Ul = this.$.listOfEvents;

		if(this.eventList){
			for( var i = 0; i < this.eventList.length ; i++){

			  
			  var newListElement = document.createElement("li");
			  var newParagraph = document.createElement("p"); 
			  var newLink = document.createElement("a");
			  
			  newParagraph.innerHTML = this.formatStartTime(this.eventList[i]);
			  newLink.href = this.getMoreInfoLink(this.eventList[i].link);
			  newLink.innerHTML = this.eventList[i].title.$t;
			  
			  newParagraph.appendChild(newLink);
			  newListElement.appendChild(newParagraph);
			  
			  
			  Ul.appendChild(newListElement);
			}
		}
		else{
			throw new Error("invalidDate");
		}
		*/
		
	  },
      getMoreInfoLink: function (links) {
		//Can use the same idea to generate the hrefs for the wiki links.
		
		/*if (!links || links.length < 1) {
          return '#';
        }

        for (var i = 0; i < links.length; i++) {
          if (links[i].rel === 'alternate' && links[i].type === 'text/html') {
            return links[i].href;
          }
        }

        return '#'; */
      }
    });
  </script>
</dom-module>